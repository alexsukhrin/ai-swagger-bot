# API Proxy Architecture - –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–ø–∏—Ç–∞–≤: *"—á–∏ –º–æ–∂–µ –±–æ—Ç —Ä–æ–∑—É–º—ñ—Ç–∏ —Ç–∞ —è–∫ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏? —â–æ–± –∫–æ–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è —Å—Ç–æ—Å–æ–≤–Ω–æ API –≤–∏–∫–æ–Ω—É–≤–∞–≤—Å—è –ø–æ—à—É–∫ –ø–æ –Ω–∞—à–æ–º—É –±–µ–∫–µ–Ω–¥—É —è–∫–∏–π –∑–∞—Ä–∞–∑ –Ω–∞ –ø–æ—Ä—Ç—É 8000 –∞ –≤–∂–µ –±–µ–∫–µ–Ω–¥ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —á–∏ –≤–∏–¥–∞–ª–µ–Ω—ñ —á–∏ –æ–Ω–æ–≤–ª–µ–Ω—ñ —Ä–æ–±–∏–≤ –≤–∏–∫–ª–∏–∫ —ñ–Ω—à–æ–≥–æ API –Ω–∞ –ø–æ—Ä—Ç—É —è–∫–∏–π –∑–∞—Ä–∞–∑ 3030 –∞–ª–µ —Ü–µ–π —Å–µ—Ä–≤—ñ—Å –ø—Ä–∞–≤–¥–∞ –∑–∞—Ä–∞–∑ —Ç–µ–∂ –≤ –¥–æ–∫–µ—Ä—ñ —Ç–æ –º–æ–∂–µ 0.0.0.0:3030 –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏"*

## –†—ñ—à–µ–Ω–Ω—è

–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ **API Proxy Architecture** –∑ –Ω–∞—Å—Ç—É–ø–Ω–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é:

### üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ    ‚îÇ   Bot API       ‚îÇ    ‚îÇ   API Service   ‚îÇ
‚îÇ   (Port 8501)   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   (Port 8000)   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   (Port 3031)   ‚îÇ
‚îÇ   Streamlit     ‚îÇ    ‚îÇ   FastAPI       ‚îÇ    ‚îÇ   Express.js    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üìã –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

1. **Frontend (Streamlit)** - —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
2. **Bot API (FastAPI)** - –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø—Ä–æ–∫—Å—ñ
3. **API Service (Express.js)** - —Ä–µ–∞–ª—å–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –¥–∞–Ω–∏–º–∏

## –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### 1. –ú–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è InteractiveSwaggerAgent

**–î–æ–¥–∞–Ω–æ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è base_url:**

```python
def __init__(
    self,
    swagger_spec_path: str,
    enable_api_calls: bool = False,
    openai_api_key: Optional[str] = None,
    jwt_token: Optional[str] = None,
    base_url_override: Optional[str] = None,  # ‚Üê –ù–æ–≤–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä
):
    # ...
    self.base_url = base_url_override or self.parser.get_base_url()
```

### 2. –û–Ω–æ–≤–ª–µ–Ω–Ω—è API endpoint

**–î–æ–¥–∞–Ω–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –¥–ª—è API —Å–µ—Ä–≤—ñ—Å—É:**

```python
# –û—Ç—Ä–∏–º—É—î–º–æ URL API —Å–µ—Ä–≤—ñ—Å—É –∑ –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
api_service_url = os.getenv("API_SERVICE_URL", "http://0.0.0.0:3031")

agent = InteractiveSwaggerAgent(
    swagger_spec_path=temp_file_path,
    enable_api_calls=True,
    openai_api_key=os.getenv("OPENAI_API_KEY"),
    jwt_token=os.getenv("JWT_TOKEN"),
    base_url_override=api_service_url  # ‚Üê –ü–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∞—î–º–æ URL
)
```

### 3. Docker Compose –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

**–î–æ–¥–∞–Ω–æ API —Å–µ—Ä–≤—ñ—Å:**

```yaml
# API Service (External API that bot will call)
api-service:
  build: ./api-service
  container_name: ai-swagger-bot-api-service
  ports:
    - "3031:3030"
  environment:
    - NODE_ENV=development
    - PORT=3030
  restart: unless-stopped
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:3030/health"]
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 40s
```

**–î–æ–¥–∞–Ω–æ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è API:**

```yaml
environment:
  - API_SERVICE_URL=${API_SERVICE_URL:-http://0.0.0.0:3031}
```

### 4. API Service (Express.js)

**–°—Ç–≤–æ—Ä–µ–Ω–æ –ø—Ä–æ—Å—Ç–∏–π API —Å–µ—Ä–≤—ñ—Å –∑ endpoints:**

```javascript
// Health check
app.get('/health', (req, res) => {
  res.json({ status: 'healthy', timestamp: new Date().toISOString() });
});

// Users endpoints
app.get('/users', (req, res) => {
  res.json(users);
});

app.post('/users', (req, res) => {
  // –õ–æ–≥—ñ–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
});

// Products endpoints
app.get('/products', (req, res) => {
  res.json(products);
});

// Orders endpoints
app.get('/orders', (req, res) => {
  res.json(orders);
});
```

## –ü—Ä–æ—Ü–µ—Å —Ä–æ–±–æ—Ç–∏

### üîÑ Flow –∑–∞–ø–∏—Ç—É

1. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á** –∑–∞–¥–∞—î –ø–∏—Ç–∞–Ω–Ω—è —á–µ—Ä–µ–∑ Streamlit
2. **Bot API** –∞–Ω–∞–ª—ñ–∑—É—î –∑–∞–ø–∏—Ç —Ç–∞ —Ñ–æ—Ä–º—É—î API –∑–∞–ø–∏—Ç
3. **Bot API** –≤–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç –¥–æ **API Service**
4. **API Service** –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å
5. **Bot API** —Ñ–æ—Ä–º–∞—Ç—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å —á–µ—Ä–µ–∑ GPT
6. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á** –æ—Ç—Ä–∏–º—É—î –¥—Ä—É–∂–µ–ª—é–±–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å

### üìä –ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Ç—É

**–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:** "–ü–æ–∫–∞–∂–∏ –≤—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤"

**Bot API:**
```python
# –§–æ—Ä–º—É—î –∑–∞–ø–∏—Ç
api_request = {
    "url": "http://0.0.0.0:3031/users",
    "method": "GET",
    "headers": {...}
}

# –í–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç
response = requests.get("http://0.0.0.0:3031/users")

# –§–æ—Ä–º–∞—Ç—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å —á–µ—Ä–µ–∑ GPT
formatted_response = gpt_process(response.json())
```

**API Service:**
```javascript
// –ü–æ–≤–µ—Ä—Ç–∞—î –¥–∞–Ω—ñ
[
  { "id": 1, "name": "John Doe", "email": "john@example.com" },
  { "id": 2, "name": "Jane Smith", "email": "jane@example.com" }
]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** "–û—Å—å —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: John Doe (john@example.com) —Ç–∞ Jane Smith (jane@example.com)"

## –ü–µ—Ä–µ–≤–∞–≥–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

### ‚úÖ –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ
- **Bot API** - –æ–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ AI
- **API Service** - –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ —Ç–∞ –¥–∞–Ω—ñ
- **Frontend** - —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### ‚úÖ –ì–Ω—É—á–∫—ñ—Å—Ç—å
- –ú–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –∑–º—ñ–Ω–∏—Ç–∏ API Service
- Bot –ø—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–∏–º API
- –ù–µ–∑–∞–ª–µ–∂–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

### ‚úÖ –ë–µ–∑–ø–µ–∫–∞
- Bot API —è–∫ –ø—Ä–æ–∫—Å—ñ/—Ñ–∞—Å–∞–¥
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É —á–µ—Ä–µ–∑ Bot API
- –Ü–∑–æ–ª—è—Ü—ñ—è API Service

### ‚úÖ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –∫–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–∫—Ä–µ–º–æ
- –ú–æ–∂–Ω–∞ –º–æ–∫–∞—Ç–∏ API Service –¥–ª—è —Ç–µ—Å—Ç—ñ–≤
- –ù–µ–∑–∞–ª–µ–∂–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

## –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

```bash
# .env —Ñ–∞–π–ª
API_SERVICE_URL=http://0.0.0.0:3031
OPENAI_API_KEY=your_openai_key
JWT_TOKEN=your_jwt_token
```

### Docker Compose

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å—ñ—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
docker-compose up -d

# –¢—ñ–ª—å–∫–∏ API —Å–µ—Ä–≤—ñ—Å
docker-compose up -d api-service

# –ü–µ—Ä–µ–±—É–¥—É–≤–∞–Ω–Ω—è
docker-compose up -d --build
```

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### Health Check
```bash
curl http://localhost:3031/health
# {"status":"healthy","timestamp":"2025-08-08T11:11:18.908Z"}
```

### API Endpoints
```bash
# –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ
curl http://localhost:3031/users

# –¢–æ–≤–∞—Ä–∏
curl http://localhost:3031/products

# –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è
curl http://localhost:3031/orders
```

### –ß–µ—Ä–µ–∑ Bot
```bash
# –ß–µ—Ä–µ–∑ Streamlit
# –ó–∞–ø–∏—Ç: "–ü–æ–∫–∞–∂–∏ –≤—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –§–æ—Ä–º–∞—Ç—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ GPT
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
ai-swagger-bot/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ main.py                    # Bot API (FastAPI)
‚îú‚îÄ‚îÄ api-service/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                 # API Service –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ package.json              # Node.js –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îÇ   ‚îî‚îÄ‚îÄ server.js                 # API Service (Express.js)
‚îú‚îÄ‚îÄ streamlit_frontend.py         # Frontend (Streamlit)
‚îú‚îÄ‚îÄ docker-compose.yml            # Docker Compose –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îî‚îÄ‚îÄ src/
    ‚îî‚îÄ‚îÄ interactive_api_agent.py  # InteractiveSwaggerAgent
```

## –í–∏—Å–Ω–æ–≤–æ–∫

–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω—É **API Proxy Architecture**, –¥–µ:

1. ‚úÖ **Bot API** –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –≤–∏–∫–æ–Ω—É—î –≤–∏–∫–ª–∏–∫–∏ –¥–æ API Service
2. ‚úÖ **API Service** –≤–∏–∫–æ–Ω—É—î —Ä–µ–∞–ª—å–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –¥–∞–Ω–∏–º–∏
3. ‚úÖ **Frontend** –Ω–∞–¥–∞—î –∑—Ä—É—á–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
4. ‚úÖ **Docker** –∑–∞–±–µ–∑–ø–µ—á—É—î —ñ–∑–æ–ª—è—Ü—ñ—é —Ç–∞ –ª–µ–≥–∫–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
5. ‚úÖ **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è** —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

–¢–µ–ø–µ—Ä –±–æ—Ç –º–æ–∂–µ —Ä–æ–∑—É–º—ñ—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω—ñ API –≤–∏–∫–ª–∏–∫–∏ –¥–æ –æ–∫—Ä–µ–º–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É! üöÄ
